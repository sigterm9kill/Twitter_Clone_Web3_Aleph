"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const utxos_1 = require("src/apis/avm/utxos");
const create_hash_1 = __importDefault(require("create-hash"));
const bintools_1 = __importDefault(require("src/utils/bintools"));
const bn_js_1 = __importDefault(require("bn.js"));
const buffer_1 = require("buffer/");
const outputs_1 = require("src/apis/avm/outputs");
const constants_1 = require("src/apis/avm/constants");
const ops_1 = require("src/apis/avm/ops");
const output_1 = require("src/common/output");
const ops_2 = require("src/apis/avm/ops");
/**
 * @ignore
 */
const bintools = bintools_1.default.getInstance();
describe('Operations', () => {
    let assetID = "8a5d2d32e68bc50036e4d086044617fe4a0a0296b274999ba568ea92da46d533";
    let assetIDBuff = buffer_1.Buffer.from(assetID, "hex");
    let addrs = [
        bintools.cb58Decode("B6D4v1VtPYLbiUvYXtW4Px8oE9imC2vGW"),
        bintools.cb58Decode("P5wdRuZeaDt28eHMP5S3w9ZdoBfo7wuzF"),
        bintools.cb58Decode("6Y3kysjF9jnHnYkdS9yGAuoHyae2eNmeV")
    ].sort();
    let locktime = new bn_js_1.default(54321);
    let addrpay = [addrs[0], addrs[1]];
    let payload = buffer_1.Buffer.alloc(1024);
    payload.write("All you Trekkies and TV addicts, Don't mean to diss don't mean to bring static.", 0, 1024, "utf8");
    describe('NFTMintOperation', () => {
        test('SelectOperationClass', () => {
            let goodop = new ops_1.NFTMintOperation(0, buffer_1.Buffer.from(""), []);
            let operation = ops_1.SelectOperationClass(goodop.getOperationID());
            expect(operation).toBeInstanceOf(ops_1.NFTMintOperation);
            expect(() => {
                ops_1.SelectOperationClass(99);
            }).toThrow("Error - SelectOperationClass: unknown opid");
        });
        test('comparator', () => {
            let outputOwners = [];
            outputOwners.push(new output_1.OutputOwners(addrs, locktime, 1));
            let op1 = new ops_1.NFTMintOperation(1, payload, outputOwners);
            let op2 = new ops_1.NFTMintOperation(2, payload, outputOwners);
            let op3 = new ops_1.NFTMintOperation(0, payload, outputOwners);
            let cmp = ops_1.NFTMintOperation.comparator();
            expect(cmp(op1, op1)).toBe(0);
            expect(cmp(op2, op2)).toBe(0);
            expect(cmp(op3, op3)).toBe(0);
            expect(cmp(op1, op2)).toBe(-1);
            expect(cmp(op1, op3)).toBe(1);
        });
        test('Functionality', () => {
            let outputOwners = [];
            outputOwners.push(new output_1.OutputOwners(addrs, locktime, 1));
            let op = new ops_1.NFTMintOperation(0, payload, outputOwners);
            expect(op.getOperationID()).toBe(constants_1.AVMConstants.NFTMINTOPID);
            expect(op.getOutputOwners().toString()).toBe(outputOwners.toString());
            let opcopy = new ops_1.NFTMintOperation();
            let opb = op.toBuffer();
            opcopy.fromBuffer(opb);
            expect(opcopy.toString()).toBe(op.toString());
        });
    });
    describe('NFTTransferOperation', () => {
        test('SelectOperationClass', () => {
            let nout = new outputs_1.NFTTransferOutput(1000, payload, addrs, locktime, 1);
            let goodop = new ops_1.NFTTransferOperation(nout);
            let operation = ops_1.SelectOperationClass(goodop.getOperationID());
            expect(operation).toBeInstanceOf(ops_1.NFTTransferOperation);
            expect(() => {
                ops_1.SelectOperationClass(99);
            }).toThrow("Error - SelectOperationClass: unknown opid");
        });
        test('comparator', () => {
            let op1 = new ops_1.NFTTransferOperation(new outputs_1.NFTTransferOutput(1000, payload, addrs, locktime, 1));
            let op2 = new ops_1.NFTTransferOperation(new outputs_1.NFTTransferOutput(1001, payload, addrs, locktime, 1));
            let op3 = new ops_1.NFTTransferOperation(new outputs_1.NFTTransferOutput(999, payload, addrs, locktime, 1));
            let cmp = ops_1.NFTTransferOperation.comparator();
            expect(cmp(op1, op1)).toBe(0);
            expect(cmp(op2, op2)).toBe(0);
            expect(cmp(op3, op3)).toBe(0);
            expect(cmp(op1, op2)).toBe(-1);
            expect(cmp(op1, op3)).toBe(1);
        });
        test('Functionality', () => {
            let nout = new outputs_1.NFTTransferOutput(1000, payload, addrs, locktime, 1);
            let op = new ops_1.NFTTransferOperation(nout);
            expect(op.getOperationID()).toBe(constants_1.AVMConstants.NFTXFEROPID);
            expect(op.getOutput().toString()).toBe(nout.toString());
            let opcopy = new ops_1.NFTTransferOperation();
            opcopy.fromBuffer(op.toBuffer());
            expect(opcopy.toString()).toBe(op.toString());
            op.addSignatureIdx(0, addrs[0]);
            let sigidx = op.getSigIdxs();
            expect(sigidx[0].getSource().toString("hex")).toBe(addrs[0].toString("hex"));
            opcopy.fromBuffer(op.toBuffer());
            expect(opcopy.toString()).toBe(op.toString());
        });
    });
    test('TransferableOperation', () => {
        let nout = new outputs_1.NFTTransferOutput(1000, payload, addrs, locktime, 1);
        let op = new ops_1.NFTTransferOperation(nout);
        let nfttxid = buffer_1.Buffer.from(create_hash_1.default("sha256").update(bintools.fromBNToBuffer(new bn_js_1.default(1000), 32)).digest());
        let nftoutputidx = buffer_1.Buffer.from(bintools.fromBNToBuffer(new bn_js_1.default(1000), 4));
        let nftutxo = new utxos_1.UTXO(constants_1.AVMConstants.LATESTCODEC, nfttxid, nftoutputidx, assetIDBuff, nout);
        let xferop = new ops_1.TransferableOperation(assetIDBuff, [nftutxo.getUTXOID()], op);
        let xferop2 = new ops_1.TransferableOperation(assetIDBuff, [buffer_1.Buffer.concat([nfttxid, nftoutputidx])], op);
        let uid = new ops_2.UTXOID();
        uid.fromString(nftutxo.getUTXOID());
        let xferop3 = new ops_1.TransferableOperation(assetIDBuff, [uid], op);
        expect(xferop.getAssetID().toString("hex")).toBe(assetID);
        let utxoiddeserialized = bintools.cb58Decode(xferop.getUTXOIDs()[0].toString());
        expect(bintools.bufferToB58(utxoiddeserialized)).toBe(nftutxo.getUTXOID());
        expect(xferop.getOperation().toString()).toBe(op.toString());
        let opcopy = new ops_1.TransferableOperation();
        opcopy.fromBuffer(xferop.toBuffer());
        expect(opcopy.toString()).toBe(xferop.toString());
        expect(xferop2.toBuffer().toString("hex")).toBe(xferop.toBuffer().toString('hex'));
        expect(xferop3.toBuffer().toString("hex")).toBe(xferop.toBuffer().toString('hex'));
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3BzLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi90ZXN0cy9hcGlzL2F2bS9vcHMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLDhDQUEwQztBQUMxQyw4REFBcUM7QUFDckMsa0VBQTBDO0FBQzFDLGtEQUF1QjtBQUN2QixvQ0FBK0I7QUFDL0Isa0RBQXlEO0FBQ3pELHNEQUFzRDtBQUN0RCwwQ0FBa0k7QUFDbEksOENBQWlEO0FBRWpELDBDQUEwQztBQUUxQzs7R0FFRztBQUNILE1BQU0sUUFBUSxHQUFHLGtCQUFRLENBQUMsV0FBVyxFQUFFLENBQUM7QUFFeEMsUUFBUSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7SUFDeEIsSUFBSSxPQUFPLEdBQVUsa0VBQWtFLENBQUM7SUFDeEYsSUFBSSxXQUFXLEdBQVUsZUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDckQsSUFBSSxLQUFLLEdBQWlCO1FBQ3RCLFFBQVEsQ0FBQyxVQUFVLENBQUMsbUNBQW1DLENBQUM7UUFDeEQsUUFBUSxDQUFDLFVBQVUsQ0FBQyxtQ0FBbUMsQ0FBQztRQUN4RCxRQUFRLENBQUMsVUFBVSxDQUFDLG1DQUFtQyxDQUFDO0tBQzNELENBQUMsSUFBSSxFQUFFLENBQUM7SUFFVCxJQUFJLFFBQVEsR0FBTSxJQUFJLGVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNoQyxJQUFJLE9BQU8sR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVuQyxJQUFJLE9BQU8sR0FBVSxlQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3hDLE9BQU8sQ0FBQyxLQUFLLENBQUMsaUZBQWlGLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxNQUFNLENBQUUsQ0FBQztJQUVuSCxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO1FBQzlCLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7WUFDOUIsSUFBSSxNQUFNLEdBQW9CLElBQUksc0JBQWdCLENBQUMsQ0FBQyxFQUFFLGVBQU0sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDM0UsSUFBSSxTQUFTLEdBQWEsMEJBQW9CLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUM7WUFDeEUsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxzQkFBZ0IsQ0FBQyxDQUFDO1lBQ25ELE1BQU0sQ0FBQyxHQUFHLEVBQUU7Z0JBQ1IsMEJBQW9CLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDN0IsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLDRDQUE0QyxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTtZQUNwQixJQUFJLFlBQVksR0FBdUIsRUFBRSxDQUFDO1lBQzFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxxQkFBWSxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN4RCxJQUFJLEdBQUcsR0FBb0IsSUFBSSxzQkFBZ0IsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO1lBQzFFLElBQUksR0FBRyxHQUFvQixJQUFJLHNCQUFnQixDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsWUFBWSxDQUFDLENBQUM7WUFDMUUsSUFBSSxHQUFHLEdBQW9CLElBQUksc0JBQWdCLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxZQUFZLENBQUMsQ0FBQztZQUMxRSxJQUFJLEdBQUcsR0FBRyxzQkFBZ0IsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUN4QyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQy9CLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xDLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7WUFDdkIsSUFBSSxZQUFZLEdBQXVCLEVBQUUsQ0FBQztZQUMxQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUkscUJBQVksQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDeEQsSUFBSSxFQUFFLEdBQW9CLElBQUksc0JBQWdCLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxZQUFZLENBQUMsQ0FBQztZQUV6RSxNQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLHdCQUFZLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDM0QsTUFBTSxDQUFDLEVBQUUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUV0RSxJQUFJLE1BQU0sR0FBb0IsSUFBSSxzQkFBZ0IsRUFBRSxDQUFDO1lBQ3JELElBQUksR0FBRyxHQUFVLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3ZCLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQTtJQUVGLFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7UUFDbEMsSUFBSSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRTtZQUM5QixJQUFJLElBQUksR0FBcUIsSUFBSSwyQkFBaUIsQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdEYsSUFBSSxNQUFNLEdBQXdCLElBQUksMEJBQW9CLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDakUsSUFBSSxTQUFTLEdBQWEsMEJBQW9CLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUM7WUFDeEUsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLGNBQWMsQ0FBQywwQkFBb0IsQ0FBQyxDQUFDO1lBQ3ZELE1BQU0sQ0FBQyxHQUFHLEVBQUU7Z0JBQ1IsMEJBQW9CLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDN0IsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLDRDQUE0QyxDQUFDLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTtZQUNwQixJQUFJLEdBQUcsR0FBd0IsSUFBSSwwQkFBb0IsQ0FBQyxJQUFJLDJCQUFpQixDQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2xILElBQUksR0FBRyxHQUF3QixJQUFJLDBCQUFvQixDQUFDLElBQUksMkJBQWlCLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbEgsSUFBSSxHQUFHLEdBQXdCLElBQUksMEJBQW9CLENBQUMsSUFBSSwyQkFBaUIsQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqSCxJQUFJLEdBQUcsR0FBRywwQkFBb0IsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUM1QyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5QixNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQy9CLE1BQU0sQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xDLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7WUFDdkIsSUFBSSxJQUFJLEdBQXFCLElBQUksMkJBQWlCLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3RGLElBQUksRUFBRSxHQUF3QixJQUFJLDBCQUFvQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBRTdELE1BQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsd0JBQVksQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMzRCxNQUFNLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBRXhELElBQUksTUFBTSxHQUF3QixJQUFJLDBCQUFvQixFQUFFLENBQUM7WUFDN0QsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztZQUNqQyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1lBRTlDLEVBQUUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLElBQUksTUFBTSxHQUFpQixFQUFFLENBQUMsVUFBVSxFQUFFLENBQUM7WUFDM0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQzdFLE1BQU0sQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDakMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFBO0lBR0YsSUFBSSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRTtRQUMvQixJQUFJLElBQUksR0FBcUIsSUFBSSwyQkFBaUIsQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDdEYsSUFBSSxFQUFFLEdBQXdCLElBQUksMEJBQW9CLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDN0QsSUFBSSxPQUFPLEdBQVUsZUFBTSxDQUFDLElBQUksQ0FBQyxxQkFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLElBQUksZUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNsSCxJQUFJLFlBQVksR0FBVSxlQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsSUFBSSxlQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoRixJQUFJLE9BQU8sR0FBUSxJQUFJLFlBQUksQ0FBQyx3QkFBWSxDQUFDLFdBQVcsRUFBRSxPQUFPLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNoRyxJQUFJLE1BQU0sR0FBeUIsSUFBSSwyQkFBcUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVyRyxJQUFJLE9BQU8sR0FBeUIsSUFBSSwyQkFBcUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxlQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUN6SCxJQUFJLEdBQUcsR0FBVSxJQUFJLFlBQU0sRUFBRSxDQUFDO1FBQzlCLEdBQUcsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDcEMsSUFBSSxPQUFPLEdBQXlCLElBQUksMkJBQXFCLENBQUMsV0FBVyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFdEYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDMUQsSUFBSSxrQkFBa0IsR0FBVSxRQUFRLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZGLE1BQU0sQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7UUFDM0UsTUFBTSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUU3RCxJQUFJLE1BQU0sR0FBeUIsSUFBSSwyQkFBcUIsRUFBRSxDQUFDO1FBQy9ELE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7UUFDckMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUVsRCxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDbkYsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQ3ZGLENBQUMsQ0FBQyxDQUFDO0FBRVAsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVVFhPIH0gZnJvbSAnc3JjL2FwaXMvYXZtL3V0eG9zJztcbmltcG9ydCBjcmVhdGVIYXNoIGZyb20gJ2NyZWF0ZS1oYXNoJztcbmltcG9ydCBCaW5Ub29scyBmcm9tICdzcmMvdXRpbHMvYmludG9vbHMnO1xuaW1wb3J0IEJOIGZyb20gJ2JuLmpzJztcbmltcG9ydCB7QnVmZmVyfSBmcm9tIFwiYnVmZmVyL1wiO1xuaW1wb3J0IHsgTkZUVHJhbnNmZXJPdXRwdXQgfSBmcm9tICdzcmMvYXBpcy9hdm0vb3V0cHV0cyc7XG5pbXBvcnQgeyBBVk1Db25zdGFudHMgfSBmcm9tICdzcmMvYXBpcy9hdm0vY29uc3RhbnRzJztcbmltcG9ydCB7IFNlbGVjdE9wZXJhdGlvbkNsYXNzLCBPcGVyYXRpb24sIFRyYW5zZmVyYWJsZU9wZXJhdGlvbiwgTkZUVHJhbnNmZXJPcGVyYXRpb24sIE5GVE1pbnRPcGVyYXRpb24gfSBmcm9tICdzcmMvYXBpcy9hdm0vb3BzJztcbmltcG9ydCB7IE91dHB1dE93bmVycyB9IGZyb20gJ3NyYy9jb21tb24vb3V0cHV0JztcbmltcG9ydCB7IFNpZ0lkeCB9IGZyb20gJ3NyYy9jb21tb24vY3JlZGVudGlhbHMnO1xuaW1wb3J0IHsgVVRYT0lEIH0gZnJvbSAnc3JjL2FwaXMvYXZtL29wcyc7XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5jb25zdCBiaW50b29scyA9IEJpblRvb2xzLmdldEluc3RhbmNlKCk7XG5cbmRlc2NyaWJlKCdPcGVyYXRpb25zJywgKCkgPT4ge1xuICAgIGxldCBhc3NldElEOnN0cmluZyA9IFwiOGE1ZDJkMzJlNjhiYzUwMDM2ZTRkMDg2MDQ0NjE3ZmU0YTBhMDI5NmIyNzQ5OTliYTU2OGVhOTJkYTQ2ZDUzM1wiO1xuICAgIGxldCBhc3NldElEQnVmZjpCdWZmZXIgPSBCdWZmZXIuZnJvbShhc3NldElELCBcImhleFwiKTtcbiAgICBsZXQgYWRkcnM6QXJyYXk8QnVmZmVyPiA9IFtcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShcIkI2RDR2MVZ0UFlMYmlVdllYdFc0UHg4b0U5aW1DMnZHV1wiKSxcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShcIlA1d2RSdVplYUR0MjhlSE1QNVMzdzlaZG9CZm83d3V6RlwiKSxcbiAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShcIjZZM2t5c2pGOWpuSG5Za2RTOXlHQXVvSHlhZTJlTm1lVlwiKVxuICAgIF0uc29ydCgpO1xuXG4gICAgbGV0IGxvY2t0aW1lOkJOID0gbmV3IEJOKDU0MzIxKTtcbiAgICBsZXQgYWRkcnBheSA9IFthZGRyc1swXSwgYWRkcnNbMV1dO1xuXG4gICAgbGV0IHBheWxvYWQ6QnVmZmVyID0gQnVmZmVyLmFsbG9jKDEwMjQpO1xuICAgIHBheWxvYWQud3JpdGUoXCJBbGwgeW91IFRyZWtraWVzIGFuZCBUViBhZGRpY3RzLCBEb24ndCBtZWFuIHRvIGRpc3MgZG9uJ3QgbWVhbiB0byBicmluZyBzdGF0aWMuXCIsIDAsIDEwMjQsIFwidXRmOFwiICk7XG5cbiAgICBkZXNjcmliZSgnTkZUTWludE9wZXJhdGlvbicsICgpID0+IHtcbiAgICAgICAgdGVzdCgnU2VsZWN0T3BlcmF0aW9uQ2xhc3MnLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgZ29vZG9wOk5GVE1pbnRPcGVyYXRpb24gPSBuZXcgTkZUTWludE9wZXJhdGlvbigwLCBCdWZmZXIuZnJvbShcIlwiKSwgW10pO1xuICAgICAgICAgICAgbGV0IG9wZXJhdGlvbjpPcGVyYXRpb24gPSBTZWxlY3RPcGVyYXRpb25DbGFzcyhnb29kb3AuZ2V0T3BlcmF0aW9uSUQoKSk7XG4gICAgICAgICAgICBleHBlY3Qob3BlcmF0aW9uKS50b0JlSW5zdGFuY2VPZihORlRNaW50T3BlcmF0aW9uKTtcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgU2VsZWN0T3BlcmF0aW9uQ2xhc3MoOTkpO1xuICAgICAgICAgICAgfSkudG9UaHJvdyhcIkVycm9yIC0gU2VsZWN0T3BlcmF0aW9uQ2xhc3M6IHVua25vd24gb3BpZFwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnY29tcGFyYXRvcicsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBvdXRwdXRPd25lcnM6QXJyYXk8T3V0cHV0T3duZXJzPiA9IFtdO1xuICAgICAgICAgICAgb3V0cHV0T3duZXJzLnB1c2gobmV3IE91dHB1dE93bmVycyhhZGRycywgbG9ja3RpbWUsIDEpKTtcbiAgICAgICAgICAgIGxldCBvcDE6TkZUTWludE9wZXJhdGlvbiA9IG5ldyBORlRNaW50T3BlcmF0aW9uKDEsIHBheWxvYWQsIG91dHB1dE93bmVycyk7XG4gICAgICAgICAgICBsZXQgb3AyOk5GVE1pbnRPcGVyYXRpb24gPSBuZXcgTkZUTWludE9wZXJhdGlvbigyLCBwYXlsb2FkLCBvdXRwdXRPd25lcnMpO1xuICAgICAgICAgICAgbGV0IG9wMzpORlRNaW50T3BlcmF0aW9uID0gbmV3IE5GVE1pbnRPcGVyYXRpb24oMCwgcGF5bG9hZCwgb3V0cHV0T3duZXJzKTtcbiAgICAgICAgICAgIGxldCBjbXAgPSBORlRNaW50T3BlcmF0aW9uLmNvbXBhcmF0b3IoKTtcbiAgICAgICAgICAgIGV4cGVjdChjbXAob3AxLCBvcDEpKS50b0JlKDApO1xuICAgICAgICAgICAgZXhwZWN0KGNtcChvcDIsIG9wMikpLnRvQmUoMCk7XG4gICAgICAgICAgICBleHBlY3QoY21wKG9wMywgb3AzKSkudG9CZSgwKTtcbiAgICAgICAgICAgIGV4cGVjdChjbXAob3AxLCBvcDIpKS50b0JlKC0xKTtcbiAgICAgICAgICAgIGV4cGVjdChjbXAob3AxLCBvcDMpKS50b0JlKDEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdGdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IG91dHB1dE93bmVyczpBcnJheTxPdXRwdXRPd25lcnM+ID0gW107XG4gICAgICAgICAgICBvdXRwdXRPd25lcnMucHVzaChuZXcgT3V0cHV0T3duZXJzKGFkZHJzLCBsb2NrdGltZSwgMSkpO1xuICAgICAgICAgICAgbGV0IG9wOk5GVE1pbnRPcGVyYXRpb24gPSBuZXcgTkZUTWludE9wZXJhdGlvbigwLCBwYXlsb2FkLCBvdXRwdXRPd25lcnMpO1xuICAgICAgICBcbiAgICAgICAgICAgIGV4cGVjdChvcC5nZXRPcGVyYXRpb25JRCgpKS50b0JlKEFWTUNvbnN0YW50cy5ORlRNSU5UT1BJRCk7XG4gICAgICAgICAgICBleHBlY3Qob3AuZ2V0T3V0cHV0T3duZXJzKCkudG9TdHJpbmcoKSkudG9CZShvdXRwdXRPd25lcnMudG9TdHJpbmcoKSk7XG4gICAgICAgIFxuICAgICAgICAgICAgbGV0IG9wY29weTpORlRNaW50T3BlcmF0aW9uID0gbmV3IE5GVE1pbnRPcGVyYXRpb24oKTtcbiAgICAgICAgICAgIGxldCBvcGI6QnVmZmVyID0gb3AudG9CdWZmZXIoKTtcbiAgICAgICAgICAgIG9wY29weS5mcm9tQnVmZmVyKG9wYik7XG4gICAgICAgICAgICBleHBlY3Qob3Bjb3B5LnRvU3RyaW5nKCkpLnRvQmUob3AudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pO1xuICAgIH0pXG5cbiAgICBkZXNjcmliZSgnTkZUVHJhbnNmZXJPcGVyYXRpb24nLCAoKSA9PiB7XG4gICAgICAgIHRlc3QoJ1NlbGVjdE9wZXJhdGlvbkNsYXNzJywgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IG5vdXQ6TkZUVHJhbnNmZXJPdXRwdXQgPSBuZXcgTkZUVHJhbnNmZXJPdXRwdXQoMTAwMCwgcGF5bG9hZCwgYWRkcnMsIGxvY2t0aW1lLCAxKTtcbiAgICAgICAgICAgIGxldCBnb29kb3A6TkZUVHJhbnNmZXJPcGVyYXRpb24gPSBuZXcgTkZUVHJhbnNmZXJPcGVyYXRpb24obm91dCk7XG4gICAgICAgICAgICBsZXQgb3BlcmF0aW9uOk9wZXJhdGlvbiA9IFNlbGVjdE9wZXJhdGlvbkNsYXNzKGdvb2RvcC5nZXRPcGVyYXRpb25JRCgpKTtcbiAgICAgICAgICAgIGV4cGVjdChvcGVyYXRpb24pLnRvQmVJbnN0YW5jZU9mKE5GVFRyYW5zZmVyT3BlcmF0aW9uKTtcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgU2VsZWN0T3BlcmF0aW9uQ2xhc3MoOTkpO1xuICAgICAgICAgICAgfSkudG9UaHJvdyhcIkVycm9yIC0gU2VsZWN0T3BlcmF0aW9uQ2xhc3M6IHVua25vd24gb3BpZFwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdCgnY29tcGFyYXRvcicsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBvcDE6TkZUVHJhbnNmZXJPcGVyYXRpb24gPSBuZXcgTkZUVHJhbnNmZXJPcGVyYXRpb24obmV3IE5GVFRyYW5zZmVyT3V0cHV0KDEwMDAsIHBheWxvYWQsIGFkZHJzLCBsb2NrdGltZSwgMSkpO1xuICAgICAgICAgICAgbGV0IG9wMjpORlRUcmFuc2Zlck9wZXJhdGlvbiA9IG5ldyBORlRUcmFuc2Zlck9wZXJhdGlvbihuZXcgTkZUVHJhbnNmZXJPdXRwdXQoMTAwMSwgcGF5bG9hZCwgYWRkcnMsIGxvY2t0aW1lLCAxKSk7XG4gICAgICAgICAgICBsZXQgb3AzOk5GVFRyYW5zZmVyT3BlcmF0aW9uID0gbmV3IE5GVFRyYW5zZmVyT3BlcmF0aW9uKG5ldyBORlRUcmFuc2Zlck91dHB1dCg5OTksIHBheWxvYWQsIGFkZHJzLCBsb2NrdGltZSwgMSkpO1xuICAgICAgICAgICAgbGV0IGNtcCA9IE5GVFRyYW5zZmVyT3BlcmF0aW9uLmNvbXBhcmF0b3IoKTtcbiAgICAgICAgICAgIGV4cGVjdChjbXAob3AxLCBvcDEpKS50b0JlKDApO1xuICAgICAgICAgICAgZXhwZWN0KGNtcChvcDIsIG9wMikpLnRvQmUoMCk7XG4gICAgICAgICAgICBleHBlY3QoY21wKG9wMywgb3AzKSkudG9CZSgwKTtcbiAgICAgICAgICAgIGV4cGVjdChjbXAob3AxLCBvcDIpKS50b0JlKC0xKTtcbiAgICAgICAgICAgIGV4cGVjdChjbXAob3AxLCBvcDMpKS50b0JlKDEpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KCdGdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IG5vdXQ6TkZUVHJhbnNmZXJPdXRwdXQgPSBuZXcgTkZUVHJhbnNmZXJPdXRwdXQoMTAwMCwgcGF5bG9hZCwgYWRkcnMsIGxvY2t0aW1lLCAxKTtcbiAgICAgICAgICAgIGxldCBvcDpORlRUcmFuc2Zlck9wZXJhdGlvbiA9IG5ldyBORlRUcmFuc2Zlck9wZXJhdGlvbihub3V0KTtcbiAgICAgICAgXG4gICAgICAgICAgICBleHBlY3Qob3AuZ2V0T3BlcmF0aW9uSUQoKSkudG9CZShBVk1Db25zdGFudHMuTkZUWEZFUk9QSUQpO1xuICAgICAgICAgICAgZXhwZWN0KG9wLmdldE91dHB1dCgpLnRvU3RyaW5nKCkpLnRvQmUobm91dC50b1N0cmluZygpKTtcbiAgICAgICAgXG4gICAgICAgICAgICBsZXQgb3Bjb3B5Ok5GVFRyYW5zZmVyT3BlcmF0aW9uID0gbmV3IE5GVFRyYW5zZmVyT3BlcmF0aW9uKCk7XG4gICAgICAgICAgICBvcGNvcHkuZnJvbUJ1ZmZlcihvcC50b0J1ZmZlcigpKTtcbiAgICAgICAgICAgIGV4cGVjdChvcGNvcHkudG9TdHJpbmcoKSkudG9CZShvcC50b1N0cmluZygpKTtcbiAgICAgICAgXG4gICAgICAgICAgICBvcC5hZGRTaWduYXR1cmVJZHgoMCwgYWRkcnNbMF0pO1xuICAgICAgICAgICAgbGV0IHNpZ2lkeDpBcnJheTxTaWdJZHg+ID0gb3AuZ2V0U2lnSWR4cygpO1xuICAgICAgICAgICAgZXhwZWN0KHNpZ2lkeFswXS5nZXRTb3VyY2UoKS50b1N0cmluZyhcImhleFwiKSkudG9CZShhZGRyc1swXS50b1N0cmluZyhcImhleFwiKSk7XG4gICAgICAgICAgICBvcGNvcHkuZnJvbUJ1ZmZlcihvcC50b0J1ZmZlcigpKTtcbiAgICAgICAgICAgIGV4cGVjdChvcGNvcHkudG9TdHJpbmcoKSkudG9CZShvcC50b1N0cmluZygpKTtcbiAgICAgICAgfSk7XG4gICAgfSlcblxuXG4gICAgdGVzdCgnVHJhbnNmZXJhYmxlT3BlcmF0aW9uJywgKCkgPT4ge1xuICAgICAgICBsZXQgbm91dDpORlRUcmFuc2Zlck91dHB1dCA9IG5ldyBORlRUcmFuc2Zlck91dHB1dCgxMDAwLCBwYXlsb2FkLCBhZGRycywgbG9ja3RpbWUsIDEpO1xuICAgICAgICBsZXQgb3A6TkZUVHJhbnNmZXJPcGVyYXRpb24gPSBuZXcgTkZUVHJhbnNmZXJPcGVyYXRpb24obm91dCk7XG4gICAgICAgIGxldCBuZnR0eGlkOkJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGNyZWF0ZUhhc2goXCJzaGEyNTZcIikudXBkYXRlKGJpbnRvb2xzLmZyb21CTlRvQnVmZmVyKG5ldyBCTigxMDAwKSwgMzIpKS5kaWdlc3QoKSk7XG4gICAgICAgIGxldCBuZnRvdXRwdXRpZHg6QnVmZmVyID0gQnVmZmVyLmZyb20oYmludG9vbHMuZnJvbUJOVG9CdWZmZXIobmV3IEJOKDEwMDApLCA0KSk7XG4gICAgICAgIGxldCBuZnR1dHhvOlVUWE8gPSBuZXcgVVRYTyhBVk1Db25zdGFudHMuTEFURVNUQ09ERUMsIG5mdHR4aWQsIG5mdG91dHB1dGlkeCwgYXNzZXRJREJ1ZmYsIG5vdXQpO1xuICAgICAgICBsZXQgeGZlcm9wOlRyYW5zZmVyYWJsZU9wZXJhdGlvbiA9IG5ldyBUcmFuc2ZlcmFibGVPcGVyYXRpb24oYXNzZXRJREJ1ZmYsIFtuZnR1dHhvLmdldFVUWE9JRCgpXSwgb3ApO1xuXG4gICAgICAgIGxldCB4ZmVyb3AyOlRyYW5zZmVyYWJsZU9wZXJhdGlvbiA9IG5ldyBUcmFuc2ZlcmFibGVPcGVyYXRpb24oYXNzZXRJREJ1ZmYsIFtCdWZmZXIuY29uY2F0KFtuZnR0eGlkLCBuZnRvdXRwdXRpZHhdKV0sIG9wKTsgXG4gICAgICAgIGxldCB1aWQ6VVRYT0lEID0gbmV3IFVUWE9JRCgpO1xuICAgICAgICB1aWQuZnJvbVN0cmluZyhuZnR1dHhvLmdldFVUWE9JRCgpKTtcbiAgICAgICAgbGV0IHhmZXJvcDM6VHJhbnNmZXJhYmxlT3BlcmF0aW9uID0gbmV3IFRyYW5zZmVyYWJsZU9wZXJhdGlvbihhc3NldElEQnVmZiwgW3VpZF0sIG9wKTtcblxuICAgICAgICBleHBlY3QoeGZlcm9wLmdldEFzc2V0SUQoKS50b1N0cmluZyhcImhleFwiKSkudG9CZShhc3NldElEKTtcbiAgICAgICAgbGV0IHV0eG9pZGRlc2VyaWFsaXplZDpCdWZmZXIgPSBiaW50b29scy5jYjU4RGVjb2RlKHhmZXJvcC5nZXRVVFhPSURzKClbMF0udG9TdHJpbmcoKSk7XG4gICAgICAgIGV4cGVjdChiaW50b29scy5idWZmZXJUb0I1OCh1dHhvaWRkZXNlcmlhbGl6ZWQpKS50b0JlKG5mdHV0eG8uZ2V0VVRYT0lEKCkpO1xuICAgICAgICBleHBlY3QoeGZlcm9wLmdldE9wZXJhdGlvbigpLnRvU3RyaW5nKCkpLnRvQmUob3AudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgbGV0IG9wY29weTpUcmFuc2ZlcmFibGVPcGVyYXRpb24gPSBuZXcgVHJhbnNmZXJhYmxlT3BlcmF0aW9uKCk7XG4gICAgICAgIG9wY29weS5mcm9tQnVmZmVyKHhmZXJvcC50b0J1ZmZlcigpKTtcbiAgICAgICAgZXhwZWN0KG9wY29weS50b1N0cmluZygpKS50b0JlKHhmZXJvcC50b1N0cmluZygpKTtcblxuICAgICAgICBleHBlY3QoeGZlcm9wMi50b0J1ZmZlcigpLnRvU3RyaW5nKFwiaGV4XCIpKS50b0JlKHhmZXJvcC50b0J1ZmZlcigpLnRvU3RyaW5nKCdoZXgnKSk7XG4gICAgICAgIGV4cGVjdCh4ZmVyb3AzLnRvQnVmZmVyKCkudG9TdHJpbmcoXCJoZXhcIikpLnRvQmUoeGZlcm9wLnRvQnVmZmVyKCkudG9TdHJpbmcoJ2hleCcpKTtcbiAgICB9KTtcblxufSk7Il19